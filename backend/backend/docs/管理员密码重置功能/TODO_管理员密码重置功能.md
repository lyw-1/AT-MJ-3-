# 管理员密码重置功能待办事项

## 1. 待优化功能

### 1.1 安全性优化
- [ ] **密码复杂度校验**
  - 实现至少包含字母、数字的密码复杂度验证
  - 添加密码强度评分机制
  - 配置位置：`UserServiceImpl`的`resetPassword`方法

- [x] **动态默认密码生成**
  - 已替代固定默认密码，使用 PasswordUtil 动态生成一次性默认密码（8–20位，仅字母与数字，需同时包含字母与数字）
  - 默认密码仅在本次响应中通过 ResetPasswordResult.defaultPasswordValue 返回给管理员，日志中不打印明文（仅记录“已生成默认密码”）
  - 配置位置：`PasswordUtil.generateDefaultPassword()`，在 `UserController.resetUserPassword` 中使用

- [ ] **会话管理优化**
  - 密码重置后强制用户重新登录
  - 清除用户的现有会话和Token
  - 配置位置：需要集成JWT Token管理模块

### 1.2 功能增强
- [ ] **用户通知机制**
  - 实现密码重置后的用户通知（邮件/站内信）
  - 通知内容包含重置时间和操作管理员
  - 配置位置：需要集成通知服务模块
  - [ ] 默认密码通过通知服务发送（生产环境策略不在响应体返回默认密码值，后端通知服务直接面向用户发送一次性默认密码；前端在重置成功弹窗中提供站内信/邮件/短信/微信触发入口）

- [ ] **批量密码重置**
  - 支持管理员批量重置多个用户的密码
  - 实现批量操作的事务管理
  - 配置位置：在`UserController`中新增批量重置接口

- [ ] **重置历史记录**
  - 实现密码重置历史记录功能
  - 记录每次密码重置的详细信息
  - 配置位置：新增密码重置历史数据表和相关服务

## 2. 待完善工作

### 2.1 测试完善
- [ ] **单元测试覆盖**
  - 完善`UserServiceImplTest`，提高测试覆盖率
  - 添加异常情况和边界条件的测试用例
  - 文件位置：`src/test/java/com/mold/digitalization/service/impl/UserServiceImplTest.java`

- [ ] **集成测试**
  - 编写API层集成测试
  - 测试权限控制和异常处理
  - 文件位置：需要创建新的测试类

### 2.2 文档更新
- [ ] **API文档更新**
  - 使用Swagger/knife4j完善API文档
  - 添加详细的接口说明和参数示例
  - 配置位置：`UserController`中的注释

- [ ] **操作手册更新**
  - 编写管理员使用密码重置功能的操作手册
  - 包含常见问题和解决方法
  - 文件位置：需要创建新的文档

### 2.3 配置优化
- [ ] **默认密码策略参数化**
  - 允许通过配置调整默认密码生成的长度范围或包含字符集（保持仅字母与数字）
  - 通过环境变量或配置文件设置熵参数，如长度、是否排除易混淆字符等
  - 配置位置：`application.properties` 或集中配置类

- [ ] **日志级别配置**
  - 优化操作日志的记录级别和详细程度
  - 支持通过配置调整日志记录内容
  - 配置位置：日志配置文件

## 3. 依赖配置

### 3.1 外部依赖
- [ ] **密码强度库**
  - 考虑引入密码强度校验库，如zxcvbn
  - 版本建议：根据Spring Boot 2.7兼容性选择
  - 配置文件：`pom.xml`

- [ ] **邮件通知组件**
  - 如果实现邮件通知，需要配置JavaMailSender
  - 配置文件：`application.properties`

### 3.2 配置文件
- [ ] **安全配置增强**
  - 更新Spring Security配置，支持更细粒度的权限控制
  - 配置文件：`SecurityConfig.java`

## 4. 优先级建议

### 高优先级（立即执行）
1. 密码复杂度校验实现
2. 动态默认密码生成
3. 完善单元测试

### 中优先级（近期计划）
1. 会话管理优化
2. API文档更新
3. 默认密码配置优化

### 低优先级（未来规划）
1. 用户通知机制
2. 批量密码重置
3. 重置历史记录

## 5. 风险提示

- **默认密码安全风险**：固定默认密码隐患已消除，仍需确保管理员妥善传达一次性默认密码并督促用户首次登录后修改
- **会话安全风险**：密码重置后用户现有会话仍有效，可能导致安全问题
- **测试覆盖不完整**：当前测试仅覆盖基础功能，需要完善边界条件和异常情况测试
