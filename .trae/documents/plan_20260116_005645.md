# 恢复完整首页设计

## 目标
将当前简化的测试页面恢复为完整的首页设计，包含所有功能模块。

## 实施步骤

1. **恢复完整的index.wxml结构**
   - 顶部导航栏
   - 搜索栏
   - 功能标签页
   - 快捷操作按钮
   - 统计卡片
   - 调模样品图片

2. **恢复完整的index.wxss样式**
   - 页面基础样式
   - 各功能模块样式
   - 确保与自定义tabBar兼容

3. **恢复完整的index.js逻辑**
   - 数据初始化
   - 事件处理
   - 与自定义tabBar的交互

4. **验证页面显示**
   - 确保所有模块正常显示
   - 验证功能交互正常

## 代码恢复计划

### 1. 恢复index.wxml
```html
<view class="page">
  <!-- 顶部导航栏 -->
  <view class="top-nav">
    <text class="nav-date">{{date}}</text>
    <text class="nav-title">主页</text>
  </view>

  <!-- 搜索栏 -->
  <view class="search-bar">
    <image class="search-icon" src="/assets/icons/search.svg"></image>
    <text class="search-text">全局智能搜索</text>
  </view>

  <!-- 功能标签页 -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'process' ? 'active' : ''}}" data-tab="process" bindtap="switchTab">
      <text class="tab-text">加工管理</text>
      <view class="tab-underline" wx:if="{{activeTab === 'process'}}"></view>
    </view>
    <view class="tab-item {{activeTab === 'adjust' ? 'active' : ''}}" data-tab="adjust" bindtap="switchTab">
      <text class="tab-text">调模管理</text>
      <view class="tab-underline" wx:if="{{activeTab === 'adjust'}}"></view>
    </view>
    <view class="tab-item {{activeTab === 'production' ? 'active' : ''}}" data-tab="production" bindtap="switchTab">
      <text class="tab-text">生产管理</text>
      <view class="tab-underline" wx:if="{{activeTab === 'production'}}"></view>
    </view>
    <view class="tab-item {{activeTab === 'equipment' ? 'active' : ''}}" data-tab="equipment" bindtap="switchTab">
      <text class="tab-text">设备管理</text>
      <view class="tab-underline" wx:if="{{activeTab === 'equipment'}}"></view>
    </view>
    <view class="tab-item {{activeTab === 'consumables' ? 'active' : ''}}" data-tab="consumables" bindtap="switchTab">
      <text class="tab-text">耗材管理</text>
      <view class="tab-underline" wx:if="{{activeTab === 'consumables'}}"></view>
    </view>
  </view>

  <!-- 快捷操作按钮 -->
  <view class="quick-actions">
    <view class="action-item">
      <text class="action-text">加工申请</text>
    </view>
    <view class="action-item">
      <text class="action-text">初始参数</text>
    </view>
    <view class="action-item">
      <text class="action-text">新模建档</text>
    </view>
    <view class="action-item">
      <text class="action-text">模具领用</text>
    </view>
    <view class="action-item">
      <text class="action-text">模具归还</text>
    </view>
  </view>

  <!-- 统计卡片 -->
  <view class="stats-grid">
    <view class="stat-card" bindtap="viewMoldPassRate">
      <text class="stat-value">{{stats.moldPassRate}}%</text>
      <text class="stat-label">模具合格率</text>
    </view>
    <view class="stat-card" bindtap="viewBareMoldCount">
      <text class="stat-value">{{stats.bareMoldCount}}</text>
      <text class="stat-label">裸模库数量</text>
    </view>
    <view class="stat-card" bindtap="viewAvailableCount">
      <text class="stat-value">{{stats.availableCount}}</text>
      <text class="stat-label">可用库数量</text>
    </view>
    <view class="stat-card" bindtap="viewLockedCount">
      <text class="stat-value">{{stats.lockedCount}}</text>
      <text class="stat-label">封层库数量</text>
    </view>
  </view>

  <!-- 调模样品图片 -->
  <view class="sample-section">
    <text class="sample-title">调模样品图片</text>
    <view class="sample-image" style="background-color: #f0f0f0;"></view>
  </view>
</view>
```

### 2. 恢复index.wxss
```css
/* 基础样式重置 */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* 页面基础样式 */
.page {
  background-color: #ffffff;
  width: 100%;
  min-height: 100vh;
  padding-bottom: 140rpx;
}

/* 顶部导航栏 */
.top-nav {
  padding: 60rpx 30rpx 20rpx;
  background-color: #ffffff;
  border-bottom: 1rpx solid #f0f0f0;
  text-align: center;
}

.nav-date {
  font-size: 28rpx;
  color: #666666;
  margin-bottom: 10rpx;
  display: block;
}

.nav-title {
  font-size: 36rpx;
  font-weight: bold;
  color: #333333;
}

/* 搜索栏 */
.search-bar {
  margin: 20rpx 30rpx;
  padding: 20rpx;
  background-color: #f5f5f5;
  border-radius: 20rpx;
  display: flex;
  align-items: center;
}

.search-icon {
  width: 40rpx;
  height: 40rpx;
  opacity: 0.5;
  margin-right: 15rpx;
}

.search-text {
  font-size: 28rpx;
  color: #999999;
}

/* 功能标签页 */
.tab-bar {
  display: flex;
  background-color: #ffffff;
  border-bottom: 1rpx solid #f0f0f0;
  overflow-x: auto;
  white-space: nowrap;
}

.tab-item {
  flex: 1;
  padding: 25rpx 0;
  text-align: center;
  position: relative;
  min-width: 120rpx;
}

.tab-text {
  font-size: 28rpx;
  color: #666666;
}

.tab-item.active .tab-text {
  color: #2678ff;
}

.tab-underline {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 60rpx;
  height: 4rpx;
  background-color: #2678ff;
  border-radius: 2rpx;
}

/* 快捷操作按钮 */
.quick-actions {
  display: flex;
  flex-wrap: wrap;
  padding: 20rpx;
  background-color: #fafafa;
}

.action-item {
  flex: 1;
  min-width: 20%;
  padding: 20rpx 0;
  text-align: center;
  background-color: #74ca00;
  border-radius: 15rpx;
  margin: 10rpx;
  color: white;
}

.action-text {
  font-size: 24rpx;
  font-weight: 500;
}

/* 统计卡片 */
.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: 1fr 1fr;
  gap: 20rpx;
  padding: 20rpx;
  background-color: #ffffff;
}

.stat-card {
  background-color: #808080;
  padding: 30rpx;
  border-radius: 15rpx;
  text-align: center;
  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);
}

.stat-value {
  font-size: 48rpx;
  font-weight: bold;
  color: #ffffff;
  margin-bottom: 10rpx;
}

.stat-label {
  font-size: 24rpx;
  color: #f0f0f0;
}

/* 调模样品图片 */
.sample-section {
  padding: 20rpx 30rpx;
  background-color: #ffffff;
}

.sample-title {
  font-size: 32rpx;
  font-weight: 500;
  color: #333333;
  margin-bottom: 20rpx;
  display: block;
}

.sample-image {
  width: 100%;
  height: 300rpx;
  background-color: #f0f0f0;
  border-radius: 15rpx;
  border: 1rpx solid #e0e0e0;
}
```

### 3. 恢复index.js
```javascript
// pages/index/index.js
Page({
  data: {
    date: '',
    activeTab: 'process',
    stats: {
      moldPassRate: 98.5,
      bareMoldCount: 123,
      availableCount: 456,
      lockedCount: 89
    }
  },

  onLoad(options) {
    // 更新日期信息
    this.updateDate()
  },

  onShow() {
    // 更新tabBar选中状态
    try {
      if (typeof this.getTabBar === 'function') {
        const tabBar = this.getTabBar()
        if (tabBar) {
          tabBar.setData({
            selected: 0
          })
        }
      }
    } catch (error) {
      console.error('更新tabBar选中状态失败:', error)
    }
  },

  // 更新日期信息
  updateDate() {
    const now = new Date()
    const date = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`
    
    this.setData({
      date
    })
  },

  // 切换功能标签
  switchTab(e) {
    const tab = e.currentTarget.dataset.tab
    this.setData({
      activeTab: tab
    })
  },

  // 查看模具合格率详情
  viewMoldPassRate() {
    wx.showToast({
      title: '查看模具合格率详情',
      icon: 'none'
    })
  },

  // 查看裸模库数量详情
  viewBareMoldCount() {
    wx.showToast({
      title: '查看裸模库数量详情',
      icon: 'none'
    })
  },

  // 查看可用库数量详情
  viewAvailableCount() {
    wx.showToast({
      title: '查看可用库数量详情',
      icon: 'none'
    })
  },

  // 查看封库库数量详情
  viewLockedCount() {
    wx.showToast({
      title: '查看封库库数量详情',
      icon: 'none'
    })
  }
})
```

## 预期效果
- 首页完整显示所有功能模块
- 各模块样式正确应用
- 功能交互正常
- 与自定义tabBar兼容

## 风险评估
- 确保所有图片资源路径正确
- 确保CSS样式不会导致页面性能问题
- 确保JavaScript逻辑不会导致页面崩溃